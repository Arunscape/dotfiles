(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),PosdAdblockInspector=function(){function PosdAdblockInspector(a){_classCallCheck(this,PosdAdblockInspector),this.id=a,this.init=!1,this.hasActiveAdblock=!1}return _createClass(PosdAdblockInspector,[{key:'Init',value:function Init(){var _this=this;if(!this.init){try{chrome.management.onEnabled.addListener(function(){_this.CheckForActiveAdblock()}),chrome.management.onDisabled.addListener(function(){_this.CheckForActiveAdblock()}),this.CheckForActiveAdblock(),void 0,this.init=!0}catch(a){}return this.init}return!1}},{key:'IsInit',value:function IsInit(){return this.init}},{key:'CheckByKeyWords',value:function CheckByKeyWords(a){for(var b=['adsblock','ads block','adblock','ad block','ublock'],c=!1,d=0;d<b.length&&!c;d++)c=a.toLowerCase().includes(b[d]);return c}},{key:'CheckForActiveAdblock',value:function CheckForActiveAdblock(){var _this2=this;try{chrome.management.getAll(function(a){for(var b=!1,c=0;c<a.length&&!b;c++)a[c].enabled&&a[c].permissions.includes('webRequestBlocking')&&(a[c].name&&_this2.CheckByKeyWords(a[c].name)||a[c].shortName&&_this2.CheckByKeyWords(a[c].shortName)||a[c].homepageUrl&&_this2.CheckByKeyWords(a[c].homepageUrl))&&(b=!0,void 0);b!==_this2.hasActiveAdblock&&(_this2.hasActiveAdblock=b,void 0)})}catch(a){}}},{key:'HasActiveAdblock',get:function get(){return this.hasActiveAdblock}}]),PosdAdblockInspector}();module.exports=PosdAdblockInspector;

},{}],2:[function(require,module,exports){
'use strict';var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}var PosdConfig=require('../config'),PosdBackgendIOManager=require('./BackendIOManager');var PosdAnalyticManager=function(){function PosdAnalyticManager(a){_classCallCheck(this,PosdAnalyticManager),this.id=a,this.init=!1,this.panelistId='',this.installEventTriggered=!1,this.sentInstallEvent=!1,this.BackgendIOManager=new PosdBackgendIOManager}return _createClass(PosdAnalyticManager,[{key:'Init',value:function Init(){if(!this.init){if(PosdConfig.CONFIG_ANALYTIC_INSTALL_EVENTS_TRACING_AVAILABLE)return void 0,chrome.runtime.onInstalled.addListener(this.onExtensionInstalled.bind(this)),this.init=!0,!0;;}return!1}},{key:'onExtensionInstalled',value:function onExtensionInstalled(a){void 0,this.installEventTriggered=!0,this.panelistId.length&&!this.sentInstallEvent&&this.SendInstallEventToBackend()}},{key:'SetPanelistId',value:function SetPanelistId(a){this.panelistId=a,this.panelistId.length&&this.installEventTriggered&&!this.sentInstallEvent&&this.SendInstallEventToBackend()}},{key:'SendInstallEventToBackend',value:function SendInstallEventToBackend(){if(PosdConfig.CONFIG_ANALYTIC_INSTALL_EVENTS_TRACING_AVAILABLE){this.sentInstallEvent=!0;var a=PosdConfig.CONFIG_PANELBACKEND_ENDPOINT+PosdConfig.CONFIG_PANELBACKEND_ENDPOINT_ULR_INSTALL_EVENT+('?panelist_id='+this.panelistId+'&distributor_id='+PosdConfig.CONFIG_DISTRIBUTOR_ID+'&partner_id='+PosdConfig.CONFIG_PARTNER_ID+'&panel_id='+PosdConfig.CONFIG_PANEL_ID);void 0,this.BackgendIOManager.SendInstallEvent(a,this.onSentInstallEvent.bind(this),this.onErrorSentInstallEvent.bind(this))}}},{key:'onSentInstallEvent',value:function onSentInstallEvent(){}},{key:'onErrorSentInstallEvent',value:function onErrorSentInstallEvent(){}}]),PosdAnalyticManager}();module.exports=PosdAnalyticManager;

},{"../config":11,"./BackendIOManager":3}],3:[function(require,module,exports){
"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),PosdConfig=require("../config"),PosdBackendIOManager=function(){function PosdBackendIOManager(){_classCallCheck(this,PosdBackendIOManager),this.init=!1}return _createClass(PosdBackendIOManager,[{key:"SendOutTicketToBackend",value:function SendOutTicketToBackend(a,b,c){a&&this.SendDataToEndpoint(a,PosdConfig.CONFIG_PANELBACKEND_ENDPOINT+PosdConfig.CONFIG_PANELBACKEND_ENDPOINT_ULR_OUTTICKET,b,c)}},{key:"SendDataToEndpoint",value:function SendDataToEndpoint(a,b,c,d){if(a&&b){var e=new XMLHttpRequest;return e.open("POST",b,!0),PosdConfig.CONFIG_USE_COMPRESSION?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","application/json"),e.onreadystatechange=function(){e.readyState==XMLHttpRequest.DONE&&(200==e.status?c&&c():d&&d())},e.send(a),!0}return!1}},{key:"SendInstallEvent",value:function SendInstallEvent(a,b,c){if(a){var d=new XMLHttpRequest;return d.open("GET",a,!0),d.onreadystatechange=function(){d.readyState==XMLHttpRequest.DONE&&(200==d.status?b&&b():c&&c())},d.send(),!0}return!1}}]),PosdBackendIOManager}();module.exports=PosdBackendIOManager;

},{"../config":11}],4:[function(require,module,exports){
'use strict';var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}var PosdConfig=require('../config'),PosdCommon=require('../libs/Common'),PosdConst=require('../libs/Constants'),PosdMessage=require('../libs/Message'),PosdTicketSender=require('./TicketSender'),PosdTicketBuilder=require('./TicketBuilder'),PosdPanelListId=require('./PanelListId'),PosdContentStorage=require('./ContentStorage'),PosdAnalyticManager=require('./AnalyticManager'),PosdAdblockInspector=require('./AdblockInspector');var PosdBackgroundContent=function(){function PosdBackgroundContent(){_classCallCheck(this,PosdBackgroundContent),this.id='bg_'+PosdCommon.GenerateQuickId(),this.TicketBuilder=new PosdTicketBuilder(this.id),this.TicketSender=new PosdTicketSender(this.id),this.PanelListId=new PosdPanelListId(this.id),this.ContentStorage=new PosdContentStorage(this.id),this.AnalyticManager=new PosdAnalyticManager(this.id),this.AdblockInspector=new PosdAdblockInspector(this.id)}return _createClass(PosdBackgroundContent,[{key:'Init',value:function Init(){void 0,this.AnalyticManager.Init(),this.PanelListId.GetId(this.onGetPanelListId.bind(this)),chrome.runtime.onMessage.addListener(this.MessageListener.bind(this)),this.TicketSender.Init(),this.TicketBuilder.Init(this.ContentStorage,this.TicketSender,this.AdblockInspector),PosdConfig.CONFIG_ADBLOCK_INSPECTOR_AVAILABLE&&this.AdblockInspector.Init()}},{key:'MessageListener',value:function MessageListener(a,b,c){if(PosdMessage.IsValid(a))if(!b.tab)a.type===PosdConst.MESSAGE_TYPE_INITIALIZATION&&a.from===PosdConst.MESSAGE_PARTICIPANT_POPUP&&(void 0,c({status:'ok',panellistid:this.PanelListId.ID}));else if(a.type===PosdConst.MESSAGE_TYPE_INITIALIZATION)c({status:'ok',panellistid:this.PanelListId.ID,tabId:b.tab.id});else if(a.type===PosdConst.MESSAGE_TYPE_IFRAME_INITIALIZATION){void 0,this.ContentStorage.AddIframeContentInfo(b.tab.id,'fr_'+b.frameId,a.content);var d=PosdMessage.EmptyMessage;d.type=PosdConst.MESSAGE_TYPE_IFRAME_INITIALIZATION_RESPONSE,d.from=this.id,d.content={frameId:b.frameId},c({status:'ok',mes:d})}else a.type===PosdConst.MESSAGE_TYPE_OUT_TICKET?this.TicketBuilder.AddTicketForBuilding(b.tab.id,a.content)?c({status:'ok'}):c({status:'error'}):a.type===PosdConst.MESSAGE_TYPE_IFRAME_CONTENT?(void 0,this.ContentStorage.AddIframeContent({tabId:b.tab.id,frameId:b.frameId,bisId:a.from,childsIframes:a.content.childsIframes,childsIframesAttributes:a.content.childsIframesAttributes,content_initial:a.content.content_initial,content_final:a.content.content_final,target_url:a.content.target_url}),c({status:'ok'})):a.type===PosdConst.MESSAGE_TYPE_GET_WINDOW_CLICK_TARGET_URL_RESPOND?(this.TicketBuilder.IsInit()&&this.TicketBuilder.onGotTicketClickTargetUrlInfo(b.tab.id,a.from,a.content),c({status:'ok'})):c({status:'error'})}},{key:'onGetPanelListId',value:function onGetPanelListId(a){void 0,this.AnalyticManager.SetPanelistId(a)}}]),PosdBackgroundContent}();module.exports=PosdBackgroundContent;

},{"../config":11,"../libs/Common":12,"../libs/Constants":13,"../libs/Message":14,"./AdblockInspector":1,"./AnalyticManager":2,"./ContentStorage":5,"./PanelListId":6,"./TicketBuilder":8,"./TicketSender":9}],5:[function(require,module,exports){
'use strict';function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),PosdContentStorage=function(){function PosdContentStorage(a){_classCallCheck(this,PosdContentStorage),this.id=a,this.init=!1,this.IframesContentStorage=[],this.IframesContentInfoStorage=[]}return _createClass(PosdContentStorage,[{key:'GetMpKey',value:function GetMpKey(a){return'mp_'+a}},{key:'AddIframeContent',value:function AddIframeContent(a){var b=this.GetMpKey(a.tabId);this.IframesContentStorage[b]||(this.IframesContentStorage[b]=[]),this.IframesContentStorage[b][a.bisId]=a}},{key:'AddIframeContentInfo',value:function AddIframeContentInfo(a,b,c){var d=this.GetMpKey(a);this.IframesContentInfoStorage[d]||(this.IframesContentInfoStorage[d]=[]),this.IframesContentInfoStorage[d][b]=c}},{key:'IsChainValidByContentInfo',value:function IsChainValidByContentInfo(a,b){var c=0,d=this.GetMpKey(a);if(b&&b.length&&this.IframesContentInfoStorage[d])for(var _e=0;_e<b.length;_e++)this.IframesContentInfoStorage[d][b[_e]]&&(c=c+this.IframesContentInfoStorage[d][b[_e]].inputsAmount);return!(1<c)}},{key:'IsChainHasRedirect',value:function IsChainHasRedirect(a,b){var c=!1,d=this.GetMpKey(a);if(b&&b.length&&this.IframesContentInfoStorage[d])for(var _e2=0;_e2<b.length&&!c;_e2++)this.IframesContentInfoStorage[d][b[_e2]]&&this.IframesContentInfoStorage[d][b[_e2]].hasRedirect&&(c=!0);return c}},{key:'GetWithoutContentIframes',value:function GetWithoutContentIframes(a,b){var c=[],d=this.GetMpKey(a);if(this.IframesContentStorage[d])for(var _e3=0;_e3<b.length;_e3++)this.IframesContentStorage[d][b[_e3]]||c.push(b[_e3]);return c}},{key:'GetIframeContentByBisId',value:function GetIframeContentByBisId(a,b){var c=this.GetMpKey(a);return this.IframesContentStorage[c]&&this.IframesContentStorage[c][b]?this.IframesContentStorage[c][b]:null}},{key:'RemoveIframeContentFromTabId',value:function RemoveIframeContentFromTabId(a){var b=this.GetMpKey(a);this.IframesContentStorage[b]&&(this.IframesContentStorage[b]=null),this.IframesContentInfoStorage[b]&&(this.IframesContentInfoStorage[b]=null),void 0}}]),PosdContentStorage}();module.exports=PosdContentStorage;

},{}],6:[function(require,module,exports){
'use strict';function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),PosdCommon=require('../libs/Common'),PosdPanelListId=function(){function PosdPanelListId(a){_classCallCheck(this,PosdPanelListId),this.id=a,this.panelListId='',this.onGotId=null,this.waitTimerId=null}return _createClass(PosdPanelListId,[{key:'GetId',value:function GetId(a){this.panelListId.length?OnGotIdCallback&&OnGotIdCallback(this.panelListId):(this.onGotId=a,chrome.storage.local.get(['panellistid'],this.onGotDataFromStorage.bind(this)),this.waitTimerId=setTimeout(this.GenerateAndSavePanelListId.bind(this),1000))}},{key:'onGotDataFromStorage',value:function onGotDataFromStorage(a){this.panelListId.length||'undefined'==typeof a||'undefined'==typeof a.panellistid||(this.panelListId=a.panellistid,void 0,this.onGotId&&this.onGotId(this.panelListId),this.waitTimerId&&(clearTimeout(this.waitTimerId),this.waitTimerId=null))}},{key:'GenerateAndSavePanelListId',value:function GenerateAndSavePanelListId(){this.panelListId.length||(this.panelListId=PosdCommon.GenerateQuickId(),chrome.storage.local.set({panellistid:this.panelListId}),void 0,this.onGotId&&this.onGotId(this.panelListId))}},{key:'DeletePanelListIdFromStorage',value:function DeletePanelListIdFromStorage(){chrome.storage.local.remove(['panellistid'])}},{key:'ID',get:function get(){return this.panelListId}}]),PosdPanelListId}();module.exports=PosdPanelListId;

},{"../libs/Common":12}],7:[function(require,module,exports){
'use strict';var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}var PosdCommon=require('../libs/Common'),PosdConfig=require('../config'),PosdBase64=require('../libs/base64'),PosdConst=require('../libs/Constants'),PosdMessage=require('../libs/Message');var PosdTicket=function(){function PosdTicket(c,d,e,f){_classCallCheck(this,PosdTicket),this.tabId=c,this.ContentStorage=e,this.AdblockInspector=f,this.rawTicket=JSON.parse(d),this.webNavigationIframes=[],this.fullIframesList=[],this.onTicketBuiltCallback=null,this.timeoutMaxBuilding=null,this.timeoutDeepTargetUrlDetection=null,this.status=PosdConst.TICKET_BUILDING_STATUS_INIT,this.ad_candidates_html5=[],this.chainsWithoutTargetUrl=[],this.finalOutTicket=''}return _createClass(PosdTicket,[{key:'IsValid',value:function IsValid(){return!0}},{key:'ActivateBuilding',value:function ActivateBuilding(c){this.onTicketBuiltCallback=c,this.rawTicket.active_adblocker=this.AdblockInspector&&this.AdblockInspector.IsInit()&&this.AdblockInspector.HasActiveAdblock,this.rawTicket.ad_candidates_html5.length?(this.status=PosdConst.TICKET_BUILDING_STATUS_STARTED,this.ad_candidates_html5=this.rawTicket.ad_candidates_html5,this.rawTicket.ad_candidates_html5=[],this.timeoutMaxBuilding=setTimeout(this.onMaxBuildingTimeout.bind(this),30000),this.GetWebNavigationIframes()):this.TicketBuildingFinished()}},{key:'GetWebNavigationIframes',value:function GetWebNavigationIframes(){var _this=this;this.status=PosdConst.TICKET_BUILDING_STATUS_GETTING_WEBNAVIGATION_IFRAMES,chrome.webNavigation.getAllFrames({tabId:this.tabId},function(c){c&&(_this.webNavigationIframes=c,_this.status=PosdConst.TICKET_BUILDING_STATUS_GOT_WEBNAVIGATION_IFRAMES,void 0,setTimeout(_this.PrepareIframeChains.bind(_this),1000),setTimeout(_this.ConstructIframeChains.bind(_this),6000))})}},{key:'GetAllFramesListForChainDetailed',value:function GetAllFramesListForChainDetailed(c){var d=[];if(d.push({parendId:'',parentDepth:0,id:parseInt(c.substring(3)),depth:0,processed:!1}),this.webNavigationIframes)for(var g=!1,h=0;h<d.length;){g=!1;for(var _l=0;_l<d.length&&!g;_l++)if(!d[_l].processed){g=!0;for(var _m5=0;_m5<this.webNavigationIframes.length;_m5++)this.webNavigationIframes[_m5].parentFrameId===d[_l].id&&d.push({parendId:this.webNavigationIframes[_m5].parentFrameId,parentDepth:d[_l].depth,id:this.webNavigationIframes[_m5].frameId,depth:d[_l].depth+1,processed:!1});d[_l].processed=!0,h=h+1}}for(var e=[],f=[],_g=0;_g<d.length;_g++){var _h='fr_'+d[_g].id,_l2='fr_'+d[_g].parendId;'fr_'==_l2&&(_l2=''),e.push(_h),f.push({bisId:_h,parendBisId:_l2,depth:d[_g].depth})}return{listIds:e,listFull:f}}},{key:'PrepareIframeChains',value:function PrepareIframeChains(){for(var g,c=[],d=[],e=0;e<this.ad_candidates_html5.length;e++)g=this.GetAllFramesListForChainDetailed(this.ad_candidates_html5[e].bis_id),this.ad_candidates_html5[e].chain=g.listIds,this.ad_candidates_html5[e].chainFull=g.listFull,this.ContentStorage.IsChainValidByContentInfo(this.tabId,this.ad_candidates_html5[e].chain)?(this.ad_candidates_html5[e].valid=!0,c=c.concat(this.ad_candidates_html5[e].chain),d.push(this.ad_candidates_html5[e].bis_id)):(void 0,this.ad_candidates_html5[e].valid=!1);if(0<c.length){var f=PosdMessage.EmptyMessage;f.type=PosdConst.MESSAGE_TYPE_GET_FRAME_CONTENT,f.multiTo=c,f.content=this.webNavigationIframes,chrome.tabs.sendMessage(this.tabId,f)}if(PosdConfig.CONFIG_MARK_AD_CANDIDATES){var f=PosdMessage.EmptyMessage;f.type=PosdConst.MESSAGE_TYPE_VALID_HTML5_CANDIDATES,f.to='mp_'+this.tabId,f.content=d,chrome.tabs.sendMessage(this.tabId,f)}}},{key:'GetChildIframesIds',value:function GetChildIframesIds(c){var d=[];if(this.webNavigationIframes.length)for(var _e=0;_e<this.webNavigationIframes.length;_e++)this.webNavigationIframes[_e].parentFrameId==c&&d.push(this.webNavigationIframes[_e].frameId);return d}},{key:'GetFullHtmlCandidateObj',value:function GetFullHtmlCandidateObj(c,d){var e={top_frame_header:'',frames:[],target_url:[]},f=[],g=[];if(d&&this.ad_candidates_html5[c]&&this.ad_candidates_html5[c].chainFull){e.top_frame_header=d.content,g.push({id:d.id,src:d.src,size:d.size,bisId:d.bis_id});for(var h=0;h<this.ad_candidates_html5[c].chainFull.length;h++){var m=this.ContentStorage.GetIframeContentByBisId(this.tabId,this.ad_candidates_html5[c].chainFull[h].bisId),n={content_final:m.content_final,depth:this.ad_candidates_html5[c].chainFull[h].depth,bis_id:this.ad_candidates_html5[c].chainFull[h].bisId,childs_bis_id:m.childsIframes,parent_bis_id:this.ad_candidates_html5[c].chainFull[h].parendBisId};e.frames.push(n),f=f.concat(m.target_url),g=g.concat(m.childsIframesAttributes)}if(f.length){f.sort(function(m,n){return n.square-m.square});for(var l=0;l<f.length;l++)e.target_url.includes(f[l].href)||e.target_url.push(f[l].href)}if(g.length)for(var h=0;h<e.frames.length;h++)for(var m=!1,l=0;l<g.length&&!m;l++)g[l].bisId===e.frames[h].bis_id&&(m=!0,e.frames[h].id=g[l].id,e.frames[h].src=g[l].src,e.frames[h].size=g[l].size);return e}}},{key:'ConstructIframeChains',value:function ConstructIframeChains(){void 0,this.status=PosdConst.TICKET_BUILDING_STATUS_CONSTRUCT_IFRAME_CHAINS_ACTIVE;for(var c=void 0,d=0;d<this.ad_candidates_html5.length;d++)this.ad_candidates_html5[d].clickTargetUrl=[],this.ad_candidates_html5[d].valid&&(c=this.GetFullHtmlCandidateObj(d,this.ad_candidates_html5[d]),c&&(this.rawTicket.ad_candidates_html5.push(c),0===c.target_url.length&&this.chainsWithoutTargetUrl.push({tabId:this.tabId,chainId:d,topFrameBisId:this.ad_candidates_html5[d].bis_id,chain:this.ad_candidates_html5[d].chain})));this.status=PosdConst.TICKET_BUILDING_STATUS_CONSTRUCT_IFRAME_CHAINS_DONE,0===this.chainsWithoutTargetUrl.length?(void 0,this.TicketBuildingFinished()):(void 0,PosdConfig.CONFIG_TARGET_URL_BY_CLICK_AVAILABLE?this.ActivateTargetUrlDeepDetection():(void 0,this.TicketBuildingFinished()))}},{key:'ActivateTargetUrlDeepDetection',value:function ActivateTargetUrlDeepDetection(){this.status=PosdConst.TICKET_BUILDING_STATUS_DEEP_TARGET_URL_DETECTION_ACTIVE,this.timeoutDeepTargetUrlDetection=setTimeout(this.onMaxDeepTargetUrlDetectionTimeout.bind(this),7000);for(var c=0;c<this.chainsWithoutTargetUrl.length;c++)if(!this.ContentStorage.IsChainHasRedirect(this.tabId,this.chainsWithoutTargetUrl[c])){var d=PosdMessage.EmptyMessage;d.type=PosdConst.MESSAGE_TYPE_DEEP_TARGET_URL_DETECTION,d.multiTo=this.chainsWithoutTargetUrl[c].chain,d.content=this.chainsWithoutTargetUrl[c],chrome.tabs.sendMessage(this.tabId,d)}else;}},{key:'onGotTicketClickTargetUrl',value:function onGotTicketClickTargetUrl(c,d,e){if(this.status!==PosdConst.TICKET_BUILDING_STATUS_DEEP_TARGET_URL_DETECTION_ACTIVE);else if(0<=d&&d<this.ad_candidates_html5.length&&e&&e.length)for(var f=0;f<e.length;f++)this.ad_candidates_html5[d].clickTargetUrl.push(e[f])}},{key:'onMaxDeepTargetUrlDetectionTimeout',value:function onMaxDeepTargetUrlDetectionTimeout(){this.status=PosdConst.TICKET_BUILDING_STATUS_DEEP_TARGET_URL_DETECTION_DONE,void 0;for(var c=0;c<this.ad_candidates_html5.length;c++)if(this.ad_candidates_html5[c].clickTargetUrl&&0<this.ad_candidates_html5[c].clickTargetUrl.length&&this.rawTicket.ad_candidates_html5[c].target_url&&0===this.rawTicket.ad_candidates_html5[c].target_url.length){this.ad_candidates_html5[c].clickTargetUrl.sort(function(e,f){return f.square-e.square});for(var d=0;d<this.ad_candidates_html5[c].clickTargetUrl.length;d++)this.rawTicket.ad_candidates_html5[c].target_url.includes(this.ad_candidates_html5[c].clickTargetUrl[d].href)||(this.rawTicket.ad_candidates_html5[c].target_url.push(this.ad_candidates_html5[c].clickTargetUrl[d].href),void 0)}this.TicketBuildingFinished()}},{key:'TicketBuildingFinished',value:function TicketBuildingFinished(){this.finalOutTicket=JSON.stringify(this.rawTicket),this.status=PosdConst.TICKET_BUILDING_STATUS_DONE,this.rawTicket=null,this.webNavigationIframes=[],this.ad_candidates_html5=[],this.timeoutMaxBuilding&&(clearTimeout(this.timeoutMaxBuilding),this.timeoutMaxBuilding=null),this.timeoutDeepTargetUrlDetection&&(clearTimeout(this.timeoutDeepTargetUrlDetection),this.timeoutDeepTargetUrlDetection=null),this.onTicketBuiltCallback&&this.onTicketBuiltCallback(this.tabId,this.finalOutTicket),this.ContentStorage.RemoveIframeContentFromTabId(this.tabId)}},{key:'onMaxBuildingTimeout',value:function onMaxBuildingTimeout(){void 0,this.rawTicket.ad_candidates_html5=[],this.TicketBuildingFinished()}},{key:'TabId',get:function get(){return this.tabId}}]),PosdTicket}();module.exports=PosdTicket;

},{"../config":11,"../libs/Common":12,"../libs/Constants":13,"../libs/Message":14,"../libs/base64":15}],8:[function(require,module,exports){
'use strict';function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),PosdTicket=require('./Ticket'),PosdTicketBuilder=function(){function PosdTicketBuilder(a){_classCallCheck(this,PosdTicketBuilder),this.id=a,this.init=!1,this.ContentStorage=null,this.TicketSender=null,this.tickets=[],this.tabsInBuilding=[]}return _createClass(PosdTicketBuilder,[{key:'IsInit',value:function IsInit(){return this.init}},{key:'Init',value:function Init(a,b,c){!this.init&&a&&b&&(this.init=!0,this.ContentStorage=a,this.TicketSender=b,this.AdblockInspector=c)}},{key:'AddTicketForBuilding',value:function AddTicketForBuilding(a,b){if(this.init)if(!this.tabsInBuilding.includes(a)){var c=new PosdTicket(a,b,this.ContentStorage,this.AdblockInspector);if(c.IsValid())return this.tickets.push(c),this.tabsInBuilding.push(a),c.ActivateBuilding(this.onTicketBuilt.bind(this)),!0;;}else;return!1}},{key:'onGotTicketClickTargetUrlInfo',value:function onGotTicketClickTargetUrlInfo(a,b,c){if(this.init)for(var d=!1,e=0;e<this.tickets.length&&!d;e++)this.tickets[e].TabId===a&&(d=!0,this.tickets[e].onGotTicketClickTargetUrl(b,c.requester_info.chainId,c.click_target_url))}},{key:'onTicketBuilt',value:function onTicketBuilt(a,b){void 0,this.TicketSender.PushTicket(b);var c=this.tabsInBuilding.indexOf(a);-1<c&&this.tabsInBuilding.splice(c,1);for(var d=!1,e=0;e<this.tickets.length&&!d;e++)this.tickets[e].TabId===a&&(d=!0,this.tickets.splice(e,1))}}]),PosdTicketBuilder}();module.exports=PosdTicketBuilder;

},{"./Ticket":7}],9:[function(require,module,exports){
'use strict';var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}var PosdConst=require('../libs/Constants'),PosdConfig=require('../config'),PosdLZString=require('../libs/lz-string'),PosdBackgendIOManager=require('./BackendIOManager');var PosdTicketSender=function(){function PosdTicketSender(a){_classCallCheck(this,PosdTicketSender),this.id=a,this.BackgendIOManager=new PosdBackgendIOManager,this.OutTicketQueue=[],this.ticketToOut=''}return _createClass(PosdTicketSender,[{key:'Init',value:function Init(){setInterval(this.SendTicket.bind(this),500)}},{key:'PushTicket',value:function PushTicket(a){return!!(this.OutTicketQueue.length<PosdConst.MAX_OUT_TICKETS_QUEUE_LENGTH)&&(this.OutTicketQueue.push(a),void 0,!0)}},{key:'SendTicket',value:function SendTicket(){if(this.OutTicketQueue.length&&!this.ticketToOut.length){this.ticketToOut=this.OutTicketQueue.shift();var a=this.ticketToOut.length;if(PosdConfig.CONFIG_USE_COMPRESSION){this.ticketToOut=PosdLZString.compressToUTF16(this.ticketToOut);var b=this.ticketToOut.length}void 0,this.BackgendIOManager.SendOutTicketToBackend(this.ticketToOut,this.onTicketSend.bind(this),this.onTicketSendError.bind(this))}}},{key:'onTicketSend',value:function onTicketSend(){this.ticketToOut='',void 0}},{key:'onTicketSendError',value:function onTicketSendError(){this.ticketToOut='',void 0}}]),PosdTicketSender}();module.exports=PosdTicketSender;

},{"../config":11,"../libs/Constants":13,"../libs/lz-string":17,"./BackendIOManager":3}],10:[function(require,module,exports){
'use strict';var PosdBackgroundContent=require('./BackgroundContent'),posdBackgroundContent=new PosdBackgroundContent;posdBackgroundContent.Init();

},{"./BackgroundContent":4}],11:[function(require,module,exports){
'use strict';function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),PosdConfig=function(){function PosdConfig(){_classCallCheck(this,PosdConfig)}return _createClass(PosdConfig,null,[{key:'CONFIG_PANELOS_VERSION',get:function get(){return'1.1.9'}},{key:'CONFIG_PANEL_ID',get:function get(){return 1}},{key:'CONFIG_PARTNER_ID',get:function get(){return 2}},{key:'CONFIG_DISTRIBUTOR_ID',get:function get(){return 2}},{key:'CONFIG_PANELBACKEND_ENDPOINT',get:function get(){return'https://pnldsk.adclarity.com:40443'}},{key:'CONFIG_PANELBACKEND_ENDPOINT_ULR_OUTTICKET',get:function get(){return'/tickets'}},{key:'CONFIG_PANELBACKEND_ENDPOINT_ULR_INSTALL_EVENT',get:function get(){return'/install'}},{key:'CONFIG_USE_COMPRESSION',get:function get(){return!0}},{key:'CONFIG_MARK_AD_CANDIDATES',get:function get(){return!1}},{key:'CONFIG_TARGET_URL_BY_CLICK_AVAILABLE',get:function get(){return!0}},{key:'CONFIG_ANALYTIC_INSTALL_EVENTS_TRACING_AVAILABLE',get:function get(){return!0}},{key:'CONFIG_ADBLOCK_INSPECTOR_AVAILABLE',get:function get(){return!0}},{key:'CONFIG_WAIT_AFTER_PAGE_LOADED_MS',get:function get(){return 5000}},{key:'CONFIG_ADS_CANDIDATES_DETECTION_CYCLE_INTERVAL_MS',get:function get(){return 60000}}]),PosdConfig}();module.exports=PosdConfig;

},{}],12:[function(require,module,exports){
'use strict';function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),PosdConst=require('./Constants'),PosdCommon=function(){function PosdCommon(){_classCallCheck(this,PosdCommon)}return _createClass(PosdCommon,null,[{key:'QuerySelectorAll',value:function QuerySelectorAll(a,b){return document.__proto__.querySelectorAll.call(a,b)}},{key:'QuerySelector',value:function QuerySelector(a,b){return document.__proto__.querySelector.call(a,b)}},{key:'Escape',value:function Escape(a){return a.replace(/\"/g,'&quot;')}},{key:'ToJSON',value:function ToJSON(a){return'function'==typeof a.toJSON?a.toJSON():JSON.stringify(a)}},{key:'GetElementSize',value:function GetElementSize(a){var b={x:0,y:0,w:0,h:0};if(a&&a.getBoundingClientRect){var d=a.getBoundingClientRect();b={x:~~(d.left+window.pageXOffset),y:~~(d.top+window.pageYOffset),w:~~d.width,h:~~d.height}}return b}},{key:'SetSizeToElement',value:function SetSizeToElement(a){var b=PosdCommon.GetElementSize(a);a.setAttribute('bis_size',PosdCommon.ToJSON(b))}},{key:'GetMainDomainFromHost',value:function GetMainDomainFromHost(a){if(a&&a.split){var b=a.split('.');if(2<=b.length)return b[b.length-2]+'.'+b[b.length-1]}return null}},{key:'GetMainDomainFromUrl',value:function GetMainDomainFromUrl(a){return PosdCommon.GetMainDomainFromHost(PosdCommon.GetHostNameFromUrl(a))}},{key:'GetHostNameFromUrl',value:function GetHostNameFromUrl(a){var b=a.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);return null!=b&&2<b.length&&'string'==typeof b[2]&&0<b[2].length?b[2]:null}},{key:'IsUrlFromHost',value:function IsUrlFromHost(a,b){return-1!==a.indexOf(PosdCommon.GetMainDomainFromUrl(b))}},{key:'GetUrlFromStyleStr',value:function GetUrlFromStyleStr(a){var b=a.replace(/"/g,'\''),d=b.indexOf('http');-1==d&&(d=b.indexOf('//'));var e=b.indexOf('\'',d),f='';return 0<d&&0<e&&d<e&&(f=b.substr(d,e-d)),f}},{key:'IsUrl',value:function IsUrl(a){return-1!==a.indexOf('http')||-1!==a.indexOf('//')}},{key:'GetCurrentDataTimeStr',value:function GetCurrentDataTimeStr(){function a(d){return 10>d?'0'+d:''+d}var b=new Date;return b.getFullYear()+'-'+a(b.getMonth()+1)+'-'+a(b.getDate())+' '+a(b.getHours())+':'+a(b.getMinutes())+':'+a(b.getSeconds())}},{key:'GetWindowSize',value:function GetWindowSize(){return{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}}},{key:'IsValidBisId',value:function IsValidBisId(a){return a.startsWith('mp_')||a.startsWith('bg_')||a.startsWith('fr_')}},{key:'GetRandomIntInRange',value:function GetRandomIntInRange(a,b){return parseInt((Math.random()*(b-a)+a).toFixed(0))}},{key:'GetCurrentTimestamp',value:function GetCurrentTimestamp(){return 0|Date.now()/1000}},{key:'GenerateQuickId',value:function GenerateQuickId(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}},{key:'GenerateTicketId',value:function GenerateTicketId(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(a){var b=0|16*Math.random(),d='x'==a?b:8|3&b;return d.toString(16)})}}]),PosdCommon}();module.exports=PosdCommon;

},{"./Constants":13}],13:[function(require,module,exports){
'use strict';function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),PosdConst=function(){function PosdConst(){_classCallCheck(this,PosdConst)}return _createClass(PosdConst,null,[{key:'MODULE_BACKGROUND',get:function get(){return'background'}},{key:'MODULE_MAINPAGE',get:function get(){return'mainpage'}},{key:'MODULE_IFRAME',get:function get(){return'iframe'}},{key:'LOG_LEVEL_ERROR',get:function get(){return'ERROR'}},{key:'LOG_LEVEL_INFO',get:function get(){return'INFO'}},{key:'LOG_LEVEL_DEBUG',get:function get(){return'DEBUG'}},{key:'MESSAGE_ID',get:function get(){return'post_mes'}},{key:'MESSAGE_PARTICIPANT_POPUP',get:function get(){return'popup'}},{key:'MESSAGE_TYPE_TEST',get:function get(){return'test'}},{key:'MESSAGE_TYPE_IFRAME_CONTENT',get:function get(){return'iframe_content'}},{key:'MESSAGE_TYPE_INITIALIZATION',get:function get(){return'initialization'}},{key:'MESSAGE_TYPE_IFRAME_INITIALIZATION',get:function get(){return'iframe_initialization'}},{key:'MESSAGE_TYPE_IFRAME_INITIALIZATION_RESPONSE',get:function get(){return'iframe_initialization_response'}},{key:'MESSAGE_TYPE_GET_ID',get:function get(){return'get_id'}},{key:'MESSAGE_TYPE_GET_ID_RESPONSE',get:function get(){return'get_id_response'}},{key:'MESSAGE_TYPE_GET_WINDOW_TARGET_URL',get:function get(){return'get_window_targer_url'}},{key:'MESSAGE_TYPE_GET_WINDOW_TARGET_URL_RESPOND',get:function get(){return'get_window_target_url_respond'}},{key:'MESSAGE_TYPE_GET_WINDOW_CLICK_TARGET_URL',get:function get(){return'get_window_click_target_url'}},{key:'MESSAGE_TYPE_GET_WINDOW_CLICK_TARGET_URL_RESPOND',get:function get(){return'get_window_click_target_url_respond'}},{key:'MESSAGE_TYPE_ROLL_CALL',get:function get(){return'roll_call'}},{key:'MESSAGE_TYPE_ROLL_CALL_BACK',get:function get(){return'roll_call_back'}},{key:'MESSAGE_TYPE_GET_FRAME_CONTENT',get:function get(){return'get_frame_content'}},{key:'MESSAGE_TYPE_DEEP_TARGET_URL_DETECTION',get:function get(){return'deep_target_url_detection'}},{key:'MESSAGE_TYPE_OUT_TICKET',get:function get(){return'out_ticket'}},{key:'MESSAGE_TYPE_VALID_HTML5_CANDIDATES',get:function get(){return'valid_html5_candidate'}},{key:'TICKET_BUILDING_STATUS_INIT',get:function get(){return 0}},{key:'TICKET_BUILDING_STATUS_STARTED',get:function get(){return 1}},{key:'TICKET_BUILDING_STATUS_GETTING_WEBNAVIGATION_IFRAMES',get:function get(){return 2}},{key:'TICKET_BUILDING_STATUS_GOT_WEBNAVIGATION_IFRAMES',get:function get(){return 3}},{key:'TICKET_BUILDING_STATUS_CONSTRUCT_IFRAME_CHAINS_ACTIVE',get:function get(){return 4}},{key:'TICKET_BUILDING_STATUS_CONSTRUCT_IFRAME_CHAINS_DONE',get:function get(){return 5}},{key:'TICKET_BUILDING_STATUS_DEEP_TARGET_URL_DETECTION_ACTIVE',get:function get(){return 6}},{key:'TICKET_BUILDING_STATUS_DEEP_TARGET_URL_DETECTION_DONE',get:function get(){return 7}},{key:'TICKET_BUILDING_STATUS_DONE',get:function get(){return 8}},{key:'MAX_OUT_TICKETS_QUEUE_LENGTH',get:function get(){return 20}},{key:'ADS_DETECTION_CYCLE_PROCESS_STATUS_NOT_STARTED',get:function get(){return 0}},{key:'ADS_DETECTION_CYCLE_PROCESS_STATUS_ACTIVE',get:function get(){return 1}},{key:'ADS_DETECTION_CYCLE_PROCESS_STATUS_FINISHED',get:function get(){return 2}}]),PosdConst}();module.exports=PosdConst;

},{}],14:[function(require,module,exports){
'use strict';function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),PosdConst=require('./Constants'),PosdMessage=function(){function PosdMessage(){_classCallCheck(this,PosdMessage)}return _createClass(PosdMessage,null,[{key:'IsValid',value:function IsValid(a){try{if('undefined'!=typeof a&&'undefined'!=typeof a.posd_message_id&&'undefined'!=typeof a.from&&'undefined'!=typeof a.to&&'undefined'!=typeof a.type&&'undefined'!=typeof a.content)return a.posd_message_id&&a.posd_message_id===PosdConst.MESSAGE_ID}catch(b){}return!1}},{key:'EmptyMessage',get:function get(){return{posd_message_id:PosdConst.MESSAGE_ID,from:'',to:'',multiTo:[],type:'',content:''}}}]),PosdMessage}();module.exports=PosdMessage;

},{"./Constants":13}],15:[function(require,module,exports){
"use strict";var PosdBase64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function encode(a){var d,e,f,g,h,j,k,b="",l=0;for(a=PosdBase64._utf8_encode(a);l<a.length;)d=a.charCodeAt(l++),e=a.charCodeAt(l++),f=a.charCodeAt(l++),g=d>>2,h=(3&d)<<4|e>>4,j=(15&e)<<2|f>>6,k=63&f,isNaN(e)?j=k=64:isNaN(f)&&(k=64),b=b+this._keyStr.charAt(g)+this._keyStr.charAt(h)+this._keyStr.charAt(j)+this._keyStr.charAt(k);return b},decode:function decode(a){var d,e,f,g,h,j,k,b="",l=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<a.length;)g=this._keyStr.indexOf(a.charAt(l++)),h=this._keyStr.indexOf(a.charAt(l++)),j=this._keyStr.indexOf(a.charAt(l++)),k=this._keyStr.indexOf(a.charAt(l++)),d=g<<2|h>>4,e=(15&h)<<4|j>>2,f=(3&j)<<6|k,b=b+String.fromCharCode(d),64!=j&&(b=b+String.fromCharCode(e)),64!=k&&(b=b+String.fromCharCode(f));return b=PosdBase64._utf8_decode(b),b},_utf8_encode:function _utf8_encode(a){a=a.replace(/\r\n/g,"\n");for(var e,b="",d=0;d<a.length;d++)e=a.charCodeAt(d),128>e?b+=String.fromCharCode(e):127<e&&2048>e?(b+=String.fromCharCode(192|e>>6),b+=String.fromCharCode(128|63&e)):(b+=String.fromCharCode(224|e>>12),b+=String.fromCharCode(128|63&e>>6),b+=String.fromCharCode(128|63&e));return b},_utf8_decode:function _utf8_decode(a){for(var b="",d=0,e=0,g=0,h=0;d<a.length;)e=a.charCodeAt(d),128>e?(b+=String.fromCharCode(e),d++):191<e&&224>e?(g=a.charCodeAt(d+1),b+=String.fromCharCode((31&e)<<6|63&g),d+=2):(g=a.charCodeAt(d+1),h=a.charCodeAt(d+2),b+=String.fromCharCode((15&e)<<12|(63&g)<<6|63&h),d+=3);return b}};module.exports=PosdBase64;

},{}],16:[function(require,module,exports){
'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&'function'==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj};try{var needJSONlib=!1;if(JSON?'function'!=typeof JSON.stringify&&(needJSONlib=!0):needJSONlib=!0,needJSONlib){var JSON;JSON||(JSON={}),function(){'use strict';function f(b){return 10>b?'0'+b:b}function quote(b){return escapable.lastIndex=0,escapable.test(b)?'"'+b.replace(escapable,function(d){var e=meta[d];return'string'==typeof e?e:'\\u'+('0000'+d.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function str(b,d){var e,g,h,l,o,m=gap,p=d[b];switch(p&&'object'==('undefined'==typeof p?'undefined':_typeof(p))&&'function'==typeof p.toJSON&&(p=p.toJSON(b)),'function'==typeof rep&&(p=rep.call(d,b,p)),'undefined'==typeof p?'undefined':_typeof(p)){case'string':return quote(p);case'number':return isFinite(p)?p+'':'null';case'boolean':case'null':return p+'';case'object':if(!p)return'null';if(gap+=indent,o=[],'[object Array]'===Object.prototype.toString.apply(p)){for(l=p.length,e=0;e<l;e+=1)o[e]=str(e,p)||'null';return h=0===o.length?'[]':gap?'[\n'+gap+o.join(',\n'+gap)+'\n'+m+']':'['+o.join(',')+']',gap=m,h}if(rep&&'object'==('undefined'==typeof rep?'undefined':_typeof(rep)))for(l=rep.length,e=0;e<l;e+=1)'string'==typeof rep[e]&&(g=rep[e],h=str(g,p),h&&o.push(quote(g)+(gap?': ':':')+h));else for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&(h=str(g,p),h&&o.push(quote(g)+(gap?': ':':')+h));return h=0===o.length?'{}':gap?'{\n'+gap+o.join(',\n'+gap)+'\n'+m+'}':'{'+o.join(',')+'}',gap=m,h;}}'function'!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(b){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z':null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(b){return this.valueOf()});var gap,indent,rep,cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"":'\\b',"	":'\\t',"\n":'\\n',"":'\\f',"\r":'\\r','"':'\\"',"\\":'\\\\'};'function'!=typeof JSON.stringify&&(JSON.stringify=function(b,d,e){var g;if(gap='',indent='','number'==typeof e)for(g=0;g<e;g+=1)indent+=' ';else'string'==typeof e&&(indent=e);if(rep=d,d&&'function'!=typeof d&&('object'!=('undefined'==typeof d?'undefined':_typeof(d))||'number'!=typeof d.length))throw new Error('JSON.stringify');return str('',{"":b})}),'function'!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(b,d){var e,g,h=b[d];if(h&&'object'==('undefined'==typeof h?'undefined':_typeof(h)))for(e in h)Object.prototype.hasOwnProperty.call(h,e)&&(g=walk(h,e),void 0===g?delete h[e]:h[e]=g);return reviver.call(b,d,h)}var j;if(text=text+'',cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(b){return'\\u'+('0000'+b.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,'')))return j=eval('('+text+')'),'function'==typeof reviver?walk({"":j},''):j;throw new SyntaxError('JSON.parse')})}()}}catch(b){}

},{}],17:[function(require,module,exports){
"use strict";var LZString=function(){function b(k,l){if(!h[k]){h[k]={};for(var m=0;m<k.length;m++)h[k][k.charAt(m)]=m}return h[k][l]}var d=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",h={},j={compressToBase64:function compressToBase64(k){if(null==k)return"";var l=j._compress(k,6,function(m){return e.charAt(m)});switch(l.length%4){default:case 0:return l;case 1:return l+"===";case 2:return l+"==";case 3:return l+"=";}},decompressFromBase64:function decompressFromBase64(k){return null==k?"":""==k?null:j._decompress(k.length,32,function(l){return b(e,k.charAt(l))})},compressToUTF16:function compressToUTF16(k){return null==k?"":j._compress(k,15,function(l){return d(l+32)})+" "},decompressFromUTF16:function decompressFromUTF16(k){return null==k?"":""==k?null:j._decompress(k.length,16384,function(l){return k.charCodeAt(l)-32})},compressToUint8Array:function compressToUint8Array(k){for(var p,l=j.compress(k),m=new Uint8Array(2*l.length),n=0,o=l.length;n<o;n++)p=l.charCodeAt(n),m[2*n]=p>>>8,m[2*n+1]=p%256;return m},decompressFromUint8Array:function decompressFromUint8Array(k){if(null===k||void 0===k)return j.decompress(k);for(var l=Array(k.length/2),m=0,n=l.length;m<n;m++)l[m]=256*k[2*m]+k[2*m+1];var o=[];return l.forEach(function(p){o.push(d(p))}),j.decompress(o.join(""))},compressToEncodedURIComponent:function compressToEncodedURIComponent(k){return null==k?"":j._compress(k,6,function(l){return g.charAt(l)})},decompressFromEncodedURIComponent:function decompressFromEncodedURIComponent(k){return null==k?"":""==k?null:(k=k.replace(/ /g,"+"),j._decompress(k.length,32,function(l){return b(g,k.charAt(l))}))},compress:function compress(k){return j._compress(k,16,function(l){return d(l)})},_compress:function _compress(k,l,m){if(null==k)return"";var n,o,B,p={},q={},r="",s="",t="",u=2,v=3,x=2,y=[],z=0,A=0;for(B=0;B<k.length;B+=1)if(r=k.charAt(B),Object.prototype.hasOwnProperty.call(p,r)||(p[r]=v++,q[r]=!0),s=t+r,Object.prototype.hasOwnProperty.call(p,s))t=s;else{if(Object.prototype.hasOwnProperty.call(q,t)){if(256>t.charCodeAt(0)){for(n=0;n<x;n++)z=z<<1,A==l-1?(A=0,y.push(m(z)),z=0):A++;for(o=t.charCodeAt(0),n=0;8>n;n++)z=z<<1|1&o,A==l-1?(A=0,y.push(m(z)),z=0):A++,o=o>>1}else{for(o=1,n=0;n<x;n++)z=z<<1|o,A==l-1?(A=0,y.push(m(z)),z=0):A++,o=0;for(o=t.charCodeAt(0),n=0;16>n;n++)z=z<<1|1&o,A==l-1?(A=0,y.push(m(z)),z=0):A++,o=o>>1}u--,0==u&&(u=Math.pow(2,x),x++),delete q[t]}else for(o=p[t],n=0;n<x;n++)z=z<<1|1&o,A==l-1?(A=0,y.push(m(z)),z=0):A++,o=o>>1;u--,0==u&&(u=Math.pow(2,x),x++),p[s]=v++,t=r+""}if(""!=t){if(Object.prototype.hasOwnProperty.call(q,t)){if(256>t.charCodeAt(0)){for(n=0;n<x;n++)z=z<<1,A==l-1?(A=0,y.push(m(z)),z=0):A++;for(o=t.charCodeAt(0),n=0;8>n;n++)z=z<<1|1&o,A==l-1?(A=0,y.push(m(z)),z=0):A++,o=o>>1}else{for(o=1,n=0;n<x;n++)z=z<<1|o,A==l-1?(A=0,y.push(m(z)),z=0):A++,o=0;for(o=t.charCodeAt(0),n=0;16>n;n++)z=z<<1|1&o,A==l-1?(A=0,y.push(m(z)),z=0):A++,o=o>>1}u--,0==u&&(u=Math.pow(2,x),x++),delete q[t]}else for(o=p[t],n=0;n<x;n++)z=z<<1|1&o,A==l-1?(A=0,y.push(m(z)),z=0):A++,o=o>>1;u--,0==u&&(u=Math.pow(2,x),x++)}for(o=2,n=0;n<x;n++)z=z<<1|1&o,A==l-1?(A=0,y.push(m(z)),z=0):A++,o=o>>1;for(;!0;)if(z=z<<1,A==l-1){y.push(m(z));break}else A++;return y.join("")},decompress:function decompress(k){return null==k?"":""==k?null:j._decompress(k.length,32768,function(l){return k.charCodeAt(l)})},_decompress:function _decompress(k,l,m){var o,u,v,x,y,z,A,B,n=[],p=4,q=4,r=3,s="",t=[],C={val:m(0),position:l,index:1};for(u=0;3>u;u+=1)n[u]=u;for(x=0,z=Math.pow(2,2),A=1;A!=z;)y=C.val&C.position,C.position>>=1,0==C.position&&(C.position=l,C.val=m(C.index++)),x|=(0<y?1:0)*A,A<<=1;switch(o=x){case 0:for(x=0,z=Math.pow(2,8),A=1;A!=z;)y=C.val&C.position,C.position>>=1,0==C.position&&(C.position=l,C.val=m(C.index++)),x|=(0<y?1:0)*A,A<<=1;B=d(x);break;case 1:for(x=0,z=Math.pow(2,16),A=1;A!=z;)y=C.val&C.position,C.position>>=1,0==C.position&&(C.position=l,C.val=m(C.index++)),x|=(0<y?1:0)*A,A<<=1;B=d(x);break;case 2:return"";}for(n[3]=B,v=B,t.push(B);!0;){if(C.index>k)return"";for(x=0,z=Math.pow(2,r),A=1;A!=z;)y=C.val&C.position,C.position>>=1,0==C.position&&(C.position=l,C.val=m(C.index++)),x|=(0<y?1:0)*A,A<<=1;switch(B=x){case 0:for(x=0,z=Math.pow(2,8),A=1;A!=z;)y=C.val&C.position,C.position>>=1,0==C.position&&(C.position=l,C.val=m(C.index++)),x|=(0<y?1:0)*A,A<<=1;n[q++]=d(x),B=q-1,p--;break;case 1:for(x=0,z=Math.pow(2,16),A=1;A!=z;)y=C.val&C.position,C.position>>=1,0==C.position&&(C.position=l,C.val=m(C.index++)),x|=(0<y?1:0)*A,A<<=1;n[q++]=d(x),B=q-1,p--;break;case 2:return t.join("");}if(0==p&&(p=Math.pow(2,r),r++),n[B])s=n[B];else if(B===q)s=v+v.charAt(0);else return null;t.push(s),n[q++]=v+s.charAt(0),p--,v=s,0==p&&(p=Math.pow(2,r),r++)}}};return j}();module.exports=LZString;

},{}]},{},[11,12,13,14,15,16,17,1,2,3,4,5,6,7,8,9,10]);
