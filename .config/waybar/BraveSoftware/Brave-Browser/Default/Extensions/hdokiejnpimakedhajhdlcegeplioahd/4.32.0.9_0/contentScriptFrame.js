LPFrame=function(){var g=0,d={},t=null,n=function(e){var t=++g,i=e.tracking,r=null,n=new LPEventManager,o=[],a=null,s=null,c=e.interfaceDefinition;d[t]=this;var l=getchromeurl(e.url);l+=(-1<l.indexOf("?")?"&":"?")+"dialogID="+t;var f=LPPlatform.newFrameContainer(l,t);this.close=function(){n.publishEvent("close"),f.close(),window.removeEventListener("resize",this.refreshPosition),window.removeEventListener("scroll",this.refreshPosition),delete d[t]},this.onClose=function(e){n.addEventListener("close",e)},this.css=function(e){f.css(e),this.refreshPosition()};var u=function(e,t,n){if(n){if("string"==typeof n){if(!n.indexOf("%"))throw"trackElement only supports numbers or percentages for translations";n=e[t]*parseInt(n.substring(0,n.indexOf("%")))/100}return n}return 0};this.refreshPosition=function(){if(i){var e=i.element.getBoundingClientRect(),t=e.top,n=e.left;i.frameTranslation&&(t+=u(f,"clientHeight",i.frameTranslation.y),n+=u(f,"clientWidth",i.frameTranslation.x)),i.targetTranslation&&(t+=u(i.element,"clientHeight",i.targetTranslation.y),n+=u(i.element,"clientWidth",i.targetTranslation.x)),f.css({top:t,left:n})}},this.trackElement=function(e){i=e,window.addEventListener("resize",this.refreshPosition),window.addEventListener("scroll",this.refreshPosition)},this.getInterface=function(){return null===s&&(a=function(e){null===r?o.push(e):LPPlatform.requestFramework.sendRequest({type:"contentScriptRequest",data:e,frameID:r})},s=Interfaces.createInstance(c,{direct:!1,context:"contentScript",requestFunction:a})),s};var h=function(){for(var e=[],t=document.getElementsByTagName("iframe"),n=0;n<t.length;++n){var i=t[n];i.src!==l&&i.getAttribute("lpsrc")!==l||e.push(i)}return e};this.initialize=function(e){if(null===r){var t=h();if(!(1<t.length)){r=e;for(var n=0;n<o.length;++n)a(o[n]);return!0}t.forEach(function(e){e.parentElement.removeChild(e)})}return!1},this.getParams=function(){return e.dialogData},this.getDialogID=function(){return t},i&&this.trackElement(i)};Topics.get(Topics.CLEAR_DATA).subscribe(function(){for(var e in d)d[e].close()});var e,i,r,o,a,s,c=function(e){return new n(e)},l,f;return{css:function(e){if(e){var t=d[e.id];t&&t.css(e.css)}"function"==typeof e.callback&&e.callback()},close:function(e){var t=d[e];t&&t.close()},openDialog:function(e,t,n){var i=c({url:"contentScriptDialog.html",interfaceDefinition:Interfaces.ContentScriptDialogInterface});return i.getInterface().LPDialog.openDialog(e,t),n&&(n.css&&i.css(n.css),n.callback&&n.callback(i.getDialogID())),i},openFrame:c,initializeRequestFramework:function(e,t,n){var i=d[e],r=!1;i&&(r=i.initialize(n)),t&&t(r)},getParams:function(e,t){t(d[e].getParams())},showModal:function(e){null===t&&(t=document.createElement("div"),LPContentScriptTools.setCSS(t,{position:"fixed","z-index":"2147483646",top:"0px",right:"0px",bottom:"0px",left:"0px","background-color":"rgba(52, 61, 68, 0.6)"})),document.body.appendChild(t)},hideModal:function(){t&&document.body.removeChild(t)},numberOfDialogs:function(){return d?Object.keys(d).length:0}}}();
//# sourceMappingURL=sourcemaps/contentScriptFrame.js.map
